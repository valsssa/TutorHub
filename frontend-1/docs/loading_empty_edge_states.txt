
# Loading, Empty & Edge States

This document defines how the application handles data retrieval states, absence of data, and network latency to maintain a high-quality user experience.

## 1. Loading Strategies

### **Skeleton Screens (Shimmer)**
Used for primary content containers to prevent layout shift (CLS) and improve perceived performance.
*   **Marketplace Grid:** Display 8 generic card skeletons while fetching tutors.
*   **Profile Page:** Show header, bio, and schedule blocks as skeletons.
*   **Tables:** Show 5 rows of gray bars for Student/Session lists.
*   **Behavior:** Skeletons must animate (pulse/shimmer) to indicate activity.

### **Spinners & Indeterminate Indicators**
Used for specific user actions or overlays.
*   **Button States:** When submitting forms (Login, Booking, Message), replace the button text with a small spinner.
*   **Infinite Scroll:** Small spinner at the bottom of the list when fetching the next page.
*   **Modals:** Central spinner if a modal requires data fetching before rendering content.

---

## 2. Empty List Behavior

The backend **MUST NOT** return `404 Not Found` for empty lists. It should return `200 OK` with an empty array `[]`.

### **Search Results (Marketplace)**
*   **Condition:** User filters result in 0 matches.
*   **UI:** "No tutors found."
*   **Action:** "Clear all filters" button.
*   **Visual:** Search icon or illustration.

### **Dashboard Lists (New User)**
*   **Condition:** User has just signed up and has no history.
*   **UI:** "You haven't booked any lessons yet."
*   **Action:** "Browse Tutors" (CTA Button).
*   **Visual:** Calendar or Empty Folder illustration.

### **Chat / Messages**
*   **Condition:** No active conversations.
*   **UI:** "Your inbox is empty."
*   **Action:** None (or "Find a tutor").

---

## 3. Partial Data & Null Handling

The frontend is designed to degrade gracefully if non-essential fields are missing.

| Field | Scenario | Fallback UI |
| :--- | :--- | :--- |
| `avatarUrl` | Null or 404 | Display colored circle with User Initials. |
| `bio` | Null or Empty String | Display "No biography provided." or hide section. |
| `rating` | 0 or Null | Display "New Tutor" badge instead of Star icon. |
| `reviews` | Empty Array | Hide "Reviews" section or show "Be the first to review!". |
| `videoUrl` | Null | Hide "Watch Video" button/thumbnail. |
| `nextLesson` | Null | Display "-" or "Not scheduled". |

---

## 4. Slow Network & Timeout Assumptions

### **Latency Thresholds**
*   **0-300ms:** Instant transition (no loading state needed for small interactions).
*   **300ms-1s:** Show Spinner/Loading state.
*   **> 10s:** Display "Taking longer than expected..." toast.
*   **> 30s:** Timeout.

### **Timeout Handling**
*   **GET Requests:** If a fetch exceeds 30 seconds, abort the request and show a "Connection timed out" error with a **Retry** button.
*   **POST (Booking/Payment):** Extended timeout (60s). If response is lost, query the transaction status before allowing retry to prevent double-booking.

### **Offline Mode**
*   If `navigator.onLine` is false:
    *   Show a global "You are offline" banner.
    *   Disable "Book Now" and "Send Message" buttons.
    *   Allow read-only access to cached data (if PWA features are enabled).
